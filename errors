2026-02-06 21:15:53,649 [INFO] chatbot: Starting Crew Chatbot API...
2026-02-06 21:15:53,650 [INFO] chatbot: LLM Model: gpt-5-2
2026-02-06 21:15:53,650 [INFO] chatbot: Mode: SQLite (v1 API)
2026-02-06 21:15:53,651 [INFO] chatbot: Database Dir: C:\Users\Shaik.Jainmaih\Chat_v1_v2\sumit_chatbot_poc\data\databases
2026-02-06 21:15:53,715 [INFO] chatbot: Database registry paths verified
2026-02-06 21:16:07,712 [INFO] chatbot: POST /api/auth/login -> 200 (589ms)
2026-02-06 21:16:11,253 [INFO] chatbot: GET /api/auth/visitor-name -> 200 (4ms)
2026-02-06 21:16:12,087 [INFO] chatbot: GET /api/chat/conversations -> 200 (6ms)
2026-02-06 21:16:20,358 [INFO] chatbot.api.chat: V1 request: conv=61 query="Hi"
2026-02-06 21:16:20,362 [INFO] chatbot.api.chat: V1 intent: GENERAL confidence=0.99
2026-02-06 21:16:20,406 [INFO] chatbot.api.chat: V1 response: intent=GENERAL has_sql=False has_results=False suggestions=0 time=73ms
2026-02-06 21:16:20,450 [INFO] chatbot: POST /api/chat/message -> 200 (119ms)
2026-02-06 21:16:21,370 [INFO] chatbot: GET /api/chat/conversations -> 200 (5ms)
2026-02-06 21:16:32,303 [INFO] chatbot.api.chat: V1 request: conv=61 query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not legal for any sequence"
2026-02-06 21:16:32,305 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=True sys_prompt_chars=0 user_preview="You are an intent classifier for an American Airlines crew management chatbot.

Classify the user's query into exactly o..."
2026-02-06 21:16:32,306 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:16:35,786 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 3480ms
2026-02-06 21:16:35,789 [INFO] chatbot.llm.client: [chat_completion] OK 3483ms | response_chars=424
2026-02-06 21:16:35,791 [INFO] chatbot.api.chat: V1 intent: DATA confidence=0.93
2026-02-06 21:16:35,879 [INFO] chatbot.sql.pipeline_v1: [pipeline] START query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not legal for any sequence" context_len=100
2026-02-06 21:16:35,884 [INFO] chatbot.sql.pipeline_v1: [retrieve_schemas] query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not lega" top_k=5 registry_dbs={'hr_payroll', 'flight_operations', 'crew_roster', 'compliance_training', 'crew_management'}
2026-02-06 21:16:35,892 [INFO] chatbot.sql.schema_cache: Schema cache loaded: 42 tables from C:\Users\Shaik.Jainmaih\Chat_v1_v2\sumit_chatbot_poc\data\databases\app.db
2026-02-06 21:16:35,893 [INFO] chatbot.sql.schema_cache: Schema cache databases: {'hr_payroll', 'flight_operations', 'fleet_maintenance', 'crew_roster', 'compliance_training', 'crew_management'}
2026-02-06 21:16:35,894 [INFO] chatbot.sql.pipeline_v1: [retrieve_schemas] Keyword match returned 9 schemas: ['crew_roster.reservescrewmember', 'fleet_maintenance.maintenance_staff', 'crew_roster.sequence', 'flight_operations.flight_legs', 'fleet_maintenance.spare_parts_inventory']
2026-02-06 21:16:35,895 [WARNING] chatbot.sql.pipeline_v1: [retrieve_schemas] Registry filter removed 3 schemas (registry has: {'hr_payroll', 'flight_operations', 'crew_roster', 'compliance_training', 'crew_management'})
2026-02-06 21:16:35,900 [INFO] chatbot.llm.client: [embedding] Single text, chars=98
2026-02-06 21:16:35,901 [INFO] chatbot.llm.client: [embedding_batch] 1 texts, total_chars=98
2026-02-06 21:16:35,902 [INFO] chatbot.llm.client: [embedding] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/text/embeddings | model=text-embeddings
2026-02-06 21:16:37,299 [INFO] chatbot.llm.client: [embedding] Response status=200 | 1397ms
2026-02-06 21:16:37,303 [INFO] chatbot.llm.client: [embedding] OK 1401ms | 1 embeddings, dims=746
2026-02-06 21:16:37,305 [INFO] chatbot.sql.pipeline_v1: [pipeline] Using 9 schemas: ['crew_roster.reservescrewmember', 'crew_roster.reservescrewmember', 'crew_roster.sequence', 'flight_operations.flight_legs', 'crew_roster.sequencepositiondetails']
2026-02-06 21:16:37,306 [INFO] chatbot.sql.pipeline_v1: [generate_sql] Sending query to LLM with 9 schemas, prompt_len=11046
2026-02-06 21:16:37,309 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=False sys_prompt_chars=0 user_preview="You are a SQL expert for an American Airlines crew management database system.
Generate a SQLite SELECT query to answer ..."
2026-02-06 21:16:37,311 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:16:44,364 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 7053ms
2026-02-06 21:16:44,368 [INFO] chatbot.llm.client: [chat_completion] OK 7057ms | response_chars=1155
2026-02-06 21:16:44,370 [INFO] chatbot.sql.pipeline_v1: [generate_sql] LLM responded in 7060ms | sql="SELECT
  b.BaseCD AS base_code,
  bd.ProcessingDate AS processing_date,
  r.EmployeeID AS employee_id,
  r.FirstName AS first_name,
  r.LastName AS la"
2026-02-06 21:16:44,376 [INFO] chatbot.sql.pipeline_v1: [pipeline] Execute attempt 1/3
2026-02-06 21:16:44,376 [INFO] chatbot.sql.pipeline_v1: [execute_sql] Executing: SELECT
  b.BaseCD AS base_code,
  bd.ProcessingDate AS processing_date,
  r.EmployeeID AS employee_id,
  r.FirstName AS first_name,
  r.LastName AS last_name,
  ld.LegalityPhaseID AS legality_phase_id
2026-02-06 21:16:44,393 [INFO] chatbot.sql.pipeline_v1: [execute_sql] OK 17ms | 0 rows, 15 columns
2026-02-06 21:16:44,394 [INFO] chatbot.sql.pipeline_v1: [pipeline] SQL executed OK | 0 rows
2026-02-06 21:16:44,395 [INFO] chatbot.sql.pipeline_v1: [pipeline] Zero rows with context, retrying without context
2026-02-06 21:16:44,396 [INFO] chatbot.sql.pipeline_v1: [generate_sql] Sending query to LLM with 9 schemas, prompt_len=10656
2026-02-06 21:16:44,397 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=False sys_prompt_chars=0 user_preview="You are a SQL expert for an American Airlines crew management database system.
Generate a SQLite SELECT query to answer ..."
2026-02-06 21:16:44,398 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:16:52,076 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 7677ms
2026-02-06 21:16:52,080 [INFO] chatbot.llm.client: [chat_completion] OK 7681ms | response_chars=1316
2026-02-06 21:16:52,082 [INFO] chatbot.sql.pipeline_v1: [generate_sql] LLM responded in 7684ms | sql="SELECT
  rcm.EmployeeID AS employee_id,
  rcm.FirstName AS first_name,
  rcm.LastName AS last_name,
  b.BaseCD AS base_code,
  bd.ProcessingDate AS pr"
2026-02-06 21:16:52,085 [INFO] chatbot.sql.pipeline_v1: [execute_sql] Executing: SELECT
  rcm.EmployeeID AS employee_id,
  rcm.FirstName AS first_name,
  rcm.LastName AS last_name,
  b.BaseCD AS base_code,
  bd.ProcessingDate AS processing_date,
  bd.BaseDateID AS base_date_id,
  
2026-02-06 21:16:52,102 [INFO] chatbot.sql.pipeline_v1: [execute_sql] OK 16ms | 100 rows, 17 columns
2026-02-06 21:16:52,102 [INFO] chatbot.sql.pipeline_v1: [pipeline] Context-free retry returned 100 rows
2026-02-06 21:16:52,104 [INFO] chatbot.sql.pipeline_v1: [summarize] Prompt length: 14793 chars, rows sent: 25/100
2026-02-06 21:16:52,106 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=False sys_prompt_chars=0 user_preview="You are a helpful assistant summarizing database query results for airline crew staff.

User's original question: For LA..."
2026-02-06 21:16:52,106 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:17:04,297 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 12190ms
2026-02-06 21:17:04,299 [INFO] chatbot.llm.client: [chat_completion] OK 12192ms | response_chars=1341
2026-02-06 21:17:04,300 [INFO] chatbot.sql.pipeline_v1: [pipeline] DONE success | attempts=1 | 28421ms | 100 rows
2026-02-06 21:17:04,301 [INFO] chatbot.api.chat: V1 response: intent=DATA has_sql=True has_results=True suggestions=3 time=32003ms
2026-02-06 21:17:04,358 [INFO] chatbot: POST /api/chat/message -> 200 (32063ms)
2026-02-06 21:17:04,368 [INFO] chatbot: GET /api/chat/conversations -> 200 (5ms)
2026-02-06 21:17:04,962 [INFO] chatbot: GET /api/admin/stats -> 200 (12ms)
2026-02-06 21:17:05,682 [INFO] chatbot: GET /api/admin/users -> 200 (4ms)
2026-02-06 21:17:06,453 [INFO] chatbot: GET /api/admin/feedback -> 200 (4ms)
2026-02-06 21:17:07,247 [INFO] chatbot: GET /api/database/upload-history -> 200 (4ms)
2026-02-06 21:17:08,029 [INFO] chatbot: GET /api/database/list -> 200 (6ms)
2026-02-06 21:17:17,283 [INFO] chatbot: PUT /api/database/crew_management/visibility -> 200 (70ms)
2026-02-06 21:17:18,107 [INFO] chatbot: GET /api/admin/stats -> 200 (13ms)
2026-02-06 21:17:18,332 [INFO] chatbot: PUT /api/database/flight_operations/visibility -> 200 (56ms)
2026-02-06 21:17:19,113 [INFO] chatbot: GET /api/admin/stats -> 200 (14ms)
2026-02-06 21:17:19,339 [INFO] chatbot: PUT /api/database/hr_payroll/visibility -> 200 (29ms)
2026-02-06 21:17:20,156 [INFO] chatbot: GET /api/admin/stats -> 200 (14ms)
2026-02-06 21:17:20,400 [INFO] chatbot: PUT /api/database/compliance_training/visibility -> 200 (69ms)
2026-02-06 21:17:21,130 [INFO] chatbot: GET /api/admin/stats -> 200 (11ms)
2026-02-06 21:17:21,807 [INFO] chatbot: GET /api/admin/users -> 200 (4ms)
2026-02-06 21:17:22,531 [INFO] chatbot: GET /api/admin/feedback -> 200 (4ms)
2026-02-06 21:17:23,323 [INFO] chatbot: GET /api/database/upload-history -> 200 (6ms)
2026-02-06 21:17:23,757 [INFO] chatbot: GET /api/chat/conversations -> 200 (6ms)
2026-02-06 21:17:28,916 [INFO] chatbot.api.chat: V1 request: conv=61 query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not legal for any sequence"
2026-02-06 21:17:28,917 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=True sys_prompt_chars=0 user_preview="You are an intent classifier for an American Airlines crew management chatbot.

Classify the user's query into exactly o..."
2026-02-06 21:17:28,917 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:17:32,494 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 3577ms
2026-02-06 21:17:32,503 [INFO] chatbot.llm.client: [chat_completion] OK 3585ms | response_chars=353
2026-02-06 21:17:32,520 [INFO] chatbot.api.chat: V1 intent: DATA confidence=0.94
2026-02-06 21:17:32,574 [INFO] chatbot.sql.pipeline_v1: [pipeline] START query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not legal for any sequence" context_len=297
2026-02-06 21:17:32,577 [INFO] chatbot.sql.pipeline_v1: [retrieve_schemas] query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not lega" top_k=5 registry_dbs={'crew_roster'}
2026-02-06 21:17:32,579 [INFO] chatbot.sql.pipeline_v1: [retrieve_schemas] Keyword match returned 9 schemas: ['crew_roster.reservescrewmember', 'fleet_maintenance.maintenance_staff', 'crew_roster.sequence', 'flight_operations.flight_legs', 'fleet_maintenance.spare_parts_inventory']
2026-02-06 21:17:32,579 [WARNING] chatbot.sql.pipeline_v1: [retrieve_schemas] Registry filter removed 4 schemas (registry has: {'crew_roster'})
2026-02-06 21:17:32,580 [INFO] chatbot.llm.client: [embedding] Single text, chars=98
2026-02-06 21:17:32,581 [INFO] chatbot.llm.client: [embedding_batch] 1 texts, total_chars=98
2026-02-06 21:17:32,582 [INFO] chatbot.llm.client: [embedding] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/text/embeddings | model=text-embeddings
2026-02-06 21:17:34,030 [INFO] chatbot.llm.client: [embedding] Response status=200 | 1447ms
2026-02-06 21:17:34,033 [INFO] chatbot.llm.client: [embedding] OK 1451ms | 1 embeddings, dims=746
2026-02-06 21:17:34,035 [INFO] chatbot.sql.pipeline_v1: [pipeline] Using 7 schemas: ['crew_roster.reservescrewmember', 'crew_roster.sequence', 'crew_roster.sequencepositiondetails', 'crew_roster.base', 'crew_roster.legalityqladetails']
2026-02-06 21:17:34,043 [INFO] chatbot.sql.pipeline_v1: [generate_sql] Sending query to LLM with 7 schemas, prompt_len=9859
2026-02-06 21:17:34,044 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=False sys_prompt_chars=0 user_preview="You are a SQL expert for an American Airlines crew management database system.
Generate a SQLite SELECT query to answer ..."
2026-02-06 21:17:34,047 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:17:52,311 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 18264ms
2026-02-06 21:17:52,313 [INFO] chatbot.llm.client: [chat_completion] OK 18266ms | response_chars=0
2026-02-06 21:17:52,314 [INFO] chatbot.sql.pipeline_v1: [generate_sql] LLM responded in 18270ms | sql=""
2026-02-06 21:17:52,314 [WARNING] chatbot.sql.pipeline_v1: [pipeline] SQL validation failed: Only SELECT statements are allowed
2026-02-06 21:17:52,315 [WARNING] chatbot.api.chat: V1 SQL pipeline failed: Generated invalid SQL: Only SELECT statements are allowed
2026-02-06 21:17:52,316 [INFO] chatbot.api.chat: V1 response: intent=DATA has_sql=False has_results=False suggestions=0 time=23406ms
2026-02-06 21:17:52,405 [INFO] chatbot: POST /api/chat/message -> 200 (23497ms)
2026-02-06 21:17:53,325 [INFO] chatbot: GET /api/chat/conversations -> 200 (4ms)




PS C:\Users\Shaik.Jainmaih\Chat_v1_v2\sumit_chatbot_poc> uvicorn backend.main:app --reload
INFO:     Will watch for changes in these directories: ['C:\\Users\\Shaik.Jainmaih\\Chat_v1_v2\\sumit_chatbot_poc']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [15056] using WatchFiles
INFO:     Started server process [384]
INFO:     Waiting for application startup.
2026-02-06 21:15:53,649 [INFO] chatbot: Starting Crew Chatbot API...
2026-02-06 21:15:53,650 [INFO] chatbot: LLM Model: gpt-5-2
2026-02-06 21:15:53,650 [INFO] chatbot: Mode: SQLite (v1 API)
2026-02-06 21:15:53,651 [INFO] chatbot: Database Dir: C:\Users\Shaik.Jainmaih\Chat_v1_v2\sumit_chatbot_poc\data\databases
[OK] database_registry seeded with mock databases (DB_DIR=C:\Users\Shaik.Jainmaih\Chat_v1_v2\sumit_chatbot_poc\data\databases)
2026-02-06 21:15:53,715 [INFO] chatbot: Database registry paths verified
INFO:     Application startup complete.
2026-02-06 21:16:07,712 [INFO] chatbot: POST /api/auth/login -> 200 (589ms)
INFO:     127.0.0.1:65203 - "POST /api/auth/login HTTP/1.1" 200 OK
2026-02-06 21:16:11,253 [INFO] chatbot: GET /api/auth/visitor-name -> 200 (4ms)
INFO:     127.0.0.1:62210 - "GET /api/auth/visitor-name?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:16:12,087 [INFO] chatbot: GET /api/chat/conversations -> 200 (6ms)
INFO:     127.0.0.1:62212 - "GET /api/chat/conversations?limit=10&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:16:20,358 [INFO] chatbot.api.chat: V1 request: conv=61 query="Hi"
2026-02-06 21:16:20,362 [INFO] chatbot.api.chat: V1 intent: GENERAL confidence=0.99
2026-02-06 21:16:20,406 [INFO] chatbot.api.chat: V1 response: intent=GENERAL has_sql=False has_results=False suggestions=0 time=73ms
2026-02-06 21:16:20,450 [INFO] chatbot: POST /api/chat/message -> 200 (119ms)
INFO:     127.0.0.1:52905 - "POST /api/chat/message?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:16:21,370 [INFO] chatbot: GET /api/chat/conversations -> 200 (5ms)
INFO:     127.0.0.1:52906 - "GET /api/chat/conversations?limit=10&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:16:32,303 [INFO] chatbot.api.chat: V1 request: conv=61 query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not legal for any sequence"
LLM Client: Chat API at https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions
LLM Client: Embedding API at https://quasarmarket.coforge.com/qag/llmrouter-api/v2/text/embeddings
LLM Client: Chat fallback at https://quasarmarket.coforge.com/qag/llmrouter-api/v3/chat/completions        
LLM Client: Embedding fallback at https://quasarmarket.coforge.com/qag/llmrouter-api/v3/text/embeddings    
  SSL verification: disabled
2026-02-06 21:16:32,305 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=True sys_prompt_chars=0 user_preview="You are an intent classifier for an American Airlines crew management chatbot.     

Classify the user's query into exactly o..."
2026-02-06 21:16:32,306 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:16:35,786 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 3480ms
2026-02-06 21:16:35,789 [INFO] chatbot.llm.client: [chat_completion] OK 3483ms | response_chars=424
2026-02-06 21:16:35,791 [INFO] chatbot.api.chat: V1 intent: DATA confidence=0.93
2026-02-06 21:16:35,879 [INFO] chatbot.sql.pipeline_v1: [pipeline] START query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not legal for any sequence" context_len=100
2026-02-06 21:16:35,884 [INFO] chatbot.sql.pipeline_v1: [retrieve_schemas] query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not lega" top_k=5 registry_dbs={'hr_payroll', 'flight_operations', 'crew_roster', 'compliance_training', 'crew_management'}
2026-02-06 21:16:35,892 [INFO] chatbot.sql.schema_cache: Schema cache loaded: 42 tables from C:\Users\Shaik.Jainmaih\Chat_v1_v2\sumit_chatbot_poc\data\databases\app.db
2026-02-06 21:16:35,893 [INFO] chatbot.sql.schema_cache: Schema cache databases: {'hr_payroll', 'flight_operations', 'fleet_maintenance', 'crew_roster', 'compliance_training', 'crew_management'}
2026-02-06 21:16:35,894 [INFO] chatbot.sql.pipeline_v1: [retrieve_schemas] Keyword match returned 9 schemas: ['crew_roster.reservescrewmember', 'fleet_maintenance.maintenance_staff', 'crew_roster.sequence', 'flight_operations.flight_legs', 'fleet_maintenance.spare_parts_inventory']
2026-02-06 21:16:35,895 [WARNING] chatbot.sql.pipeline_v1: [retrieve_schemas] Registry filter removed 3 schemas (registry has: {'hr_payroll', 'flight_operations', 'crew_roster', 'compliance_training', 'crew_management'})
Loaded FAISS index 'schema_metadata' with 42 items
2026-02-06 21:16:35,900 [INFO] chatbot.llm.client: [embedding] Single text, chars=98
2026-02-06 21:16:35,901 [INFO] chatbot.llm.client: [embedding_batch] 1 texts, total_chars=98
2026-02-06 21:16:35,902 [INFO] chatbot.llm.client: [embedding] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/text/embeddings | model=text-embeddings
2026-02-06 21:16:37,299 [INFO] chatbot.llm.client: [embedding] Response status=200 | 1397ms
2026-02-06 21:16:37,303 [INFO] chatbot.llm.client: [embedding] OK 1401ms | 1 embeddings, dims=746
2026-02-06 21:16:37,305 [INFO] chatbot.sql.pipeline_v1: [pipeline] Using 9 schemas: ['crew_roster.reservescrewmember', 'crew_roster.reservescrewmember', 'crew_roster.sequence', 'flight_operations.flight_legs', 'crew_roster.sequencepositiondetails']
2026-02-06 21:16:37,306 [INFO] chatbot.sql.pipeline_v1: [generate_sql] Sending query to LLM with 9 schemas, prompt_len=11046
2026-02-06 21:16:37,309 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=False sys_prompt_chars=0 user_preview="You are a SQL expert for an American Airlines crew management database system.    
Generate a SQLite SELECT query to answer ..."
2026-02-06 21:16:37,311 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:16:44,364 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 7053ms
2026-02-06 21:16:44,368 [INFO] chatbot.llm.client: [chat_completion] OK 7057ms | response_chars=1155
2026-02-06 21:16:44,370 [INFO] chatbot.sql.pipeline_v1: [generate_sql] LLM responded in 7060ms | sql="SELECT
  b.BaseCD AS base_code,
  bd.ProcessingDate AS processing_date,
  r.EmployeeID AS employee_id,
  r.FirstName AS first_name,
  r.LastName AS la"
2026-02-06 21:16:44,376 [INFO] chatbot.sql.pipeline_v1: [pipeline] Execute attempt 1/3
2026-02-06 21:16:44,376 [INFO] chatbot.sql.pipeline_v1: [execute_sql] Executing: SELECT
  b.BaseCD AS base_code,
  bd.ProcessingDate AS processing_date,
  r.EmployeeID AS employee_id,
  r.FirstName AS first_name,
  r.LastName AS last_name,
  ld.LegalityPhaseID AS legality_phase_id
2026-02-06 21:16:44,393 [INFO] chatbot.sql.pipeline_v1: [execute_sql] OK 17ms | 0 rows, 15 columns
2026-02-06 21:16:44,394 [INFO] chatbot.sql.pipeline_v1: [pipeline] SQL executed OK | 0 rows
2026-02-06 21:16:44,395 [INFO] chatbot.sql.pipeline_v1: [pipeline] Zero rows with context, retrying without context
2026-02-06 21:16:44,396 [INFO] chatbot.sql.pipeline_v1: [generate_sql] Sending query to LLM with 9 schemas, prompt_len=10656
2026-02-06 21:16:44,397 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=False sys_prompt_chars=0 user_preview="You are a SQL expert for an American Airlines crew management database system.    
Generate a SQLite SELECT query to answer ..."
2026-02-06 21:16:44,398 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:16:52,076 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 7677ms
2026-02-06 21:16:52,080 [INFO] chatbot.llm.client: [chat_completion] OK 7681ms | response_chars=1316
2026-02-06 21:16:52,082 [INFO] chatbot.sql.pipeline_v1: [generate_sql] LLM responded in 7684ms | sql="SELECT
  rcm.EmployeeID AS employee_id,
  rcm.FirstName AS first_name,
  rcm.LastName AS last_name,
  b.BaseCD AS base_code,
  bd.ProcessingDate AS pr"
2026-02-06 21:16:52,085 [INFO] chatbot.sql.pipeline_v1: [execute_sql] Executing: SELECT
  rcm.EmployeeID AS employee_id,
  rcm.FirstName AS first_name,
  rcm.LastName AS last_name,
  b.BaseCD AS base_code,
  bd.ProcessingDate AS processing_date,
  bd.BaseDateID AS base_date_id,

2026-02-06 21:16:52,102 [INFO] chatbot.sql.pipeline_v1: [execute_sql] OK 16ms | 100 rows, 17 columns
2026-02-06 21:16:52,102 [INFO] chatbot.sql.pipeline_v1: [pipeline] Context-free retry returned 100 rows    
2026-02-06 21:16:52,104 [INFO] chatbot.sql.pipeline_v1: [summarize] Prompt length: 14793 chars, rows sent: 25/100
2026-02-06 21:16:52,106 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=False sys_prompt_chars=0 user_preview="You are a helpful assistant summarizing database query results for airline crew staff.

User's original question: For LA..."
2026-02-06 21:16:52,106 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:17:04,297 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 12190ms
2026-02-06 21:17:04,299 [INFO] chatbot.llm.client: [chat_completion] OK 12192ms | response_chars=1341
2026-02-06 21:17:04,300 [INFO] chatbot.sql.pipeline_v1: [pipeline] DONE success | attempts=1 | 28421ms | 100 rows
2026-02-06 21:17:04,301 [INFO] chatbot.api.chat: V1 response: intent=DATA has_sql=True has_results=True suggestions=3 time=32003ms
2026-02-06 21:17:04,358 [INFO] chatbot: POST /api/chat/message -> 200 (32063ms)
INFO:     127.0.0.1:61853 - "POST /api/chat/message?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:04,368 [INFO] chatbot: GET /api/chat/conversations -> 200 (5ms)
INFO:     127.0.0.1:55132 - "GET /api/chat/conversations?limit=10&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:04,962 [INFO] chatbot: GET /api/admin/stats -> 200 (12ms)
INFO:     127.0.0.1:50327 - "GET /api/admin/stats?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:05,682 [INFO] chatbot: GET /api/admin/users -> 200 (4ms)
INFO:     127.0.0.1:50330 - "GET /api/admin/users?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:06,453 [INFO] chatbot: GET /api/admin/feedback -> 200 (4ms)
INFO:     127.0.0.1:50332 - "GET /api/admin/feedback?limit=100&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:07,247 [INFO] chatbot: GET /api/database/upload-history -> 200 (4ms)
INFO:     127.0.0.1:50335 - "GET /api/database/upload-history?limit=10&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:08,029 [INFO] chatbot: GET /api/database/list -> 200 (6ms)
INFO:     127.0.0.1:50336 - "GET /api/database/list?include_hidden=true&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:17,283 [INFO] chatbot: PUT /api/database/crew_management/visibility -> 200 (70ms)
INFO:     127.0.0.1:57444 - "PUT /api/database/crew_management/visibility?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:18,107 [INFO] chatbot: GET /api/admin/stats -> 200 (13ms)
INFO:     127.0.0.1:59967 - "GET /api/admin/stats?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:18,332 [INFO] chatbot: PUT /api/database/flight_operations/visibility -> 200 (56ms)
INFO:     127.0.0.1:59968 - "PUT /api/database/flight_operations/visibility?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:19,113 [INFO] chatbot: GET /api/admin/stats -> 200 (14ms)
INFO:     127.0.0.1:59969 - "GET /api/admin/stats?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:19,339 [INFO] chatbot: PUT /api/database/hr_payroll/visibility -> 200 (29ms)
INFO:     127.0.0.1:59970 - "PUT /api/database/hr_payroll/visibility?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:20,156 [INFO] chatbot: GET /api/admin/stats -> 200 (14ms)
INFO:     127.0.0.1:59971 - "GET /api/admin/stats?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:20,400 [INFO] chatbot: PUT /api/database/compliance_training/visibility -> 200 (69ms)
INFO:     127.0.0.1:59972 - "PUT /api/database/compliance_training/visibility?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:21,130 [INFO] chatbot: GET /api/admin/stats -> 200 (11ms)
INFO:     127.0.0.1:59973 - "GET /api/admin/stats?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:21,807 [INFO] chatbot: GET /api/admin/users -> 200 (4ms)
INFO:     127.0.0.1:59974 - "GET /api/admin/users?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:22,531 [INFO] chatbot: GET /api/admin/feedback -> 200 (4ms)
INFO:     127.0.0.1:59976 - "GET /api/admin/feedback?limit=100&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:23,323 [INFO] chatbot: GET /api/database/upload-history -> 200 (6ms)
INFO:     127.0.0.1:59977 - "GET /api/database/upload-history?limit=10&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:23,757 [INFO] chatbot: GET /api/chat/conversations -> 200 (6ms)
INFO:     127.0.0.1:59978 - "GET /api/chat/conversations?limit=10&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:28,916 [INFO] chatbot.api.chat: V1 request: conv=61 query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not legal for any sequence"
2026-02-06 21:17:28,917 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=True sys_prompt_chars=0 user_preview="You are an intent classifier for an American Airlines crew management chatbot.     

Classify the user's query into exactly o..."
2026-02-06 21:17:28,917 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:17:32,494 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 3577ms
2026-02-06 21:17:32,503 [INFO] chatbot.llm.client: [chat_completion] OK 3585ms | response_chars=353
2026-02-06 21:17:32,520 [INFO] chatbot.api.chat: V1 intent: DATA confidence=0.94
2026-02-06 21:17:32,574 [INFO] chatbot.sql.pipeline_v1: [pipeline] START query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not legal for any sequence" context_len=297
2026-02-06 21:17:32,577 [INFO] chatbot.sql.pipeline_v1: [retrieve_schemas] query="For LAX base and processing date 1/29/2026, why was employeed id 502370 not lega" top_k=5 registry_dbs={'crew_roster'}
2026-02-06 21:17:32,579 [INFO] chatbot.sql.pipeline_v1: [retrieve_schemas] Keyword match returned 9 schemas: ['crew_roster.reservescrewmember', 'fleet_maintenance.maintenance_staff', 'crew_roster.sequence', 'flight_operations.flight_legs', 'fleet_maintenance.spare_parts_inventory']
2026-02-06 21:17:32,579 [WARNING] chatbot.sql.pipeline_v1: [retrieve_schemas] Registry filter removed 4 schemas (registry has: {'crew_roster'})
2026-02-06 21:17:32,580 [INFO] chatbot.llm.client: [embedding] Single text, chars=98
2026-02-06 21:17:32,581 [INFO] chatbot.llm.client: [embedding_batch] 1 texts, total_chars=98
2026-02-06 21:17:32,582 [INFO] chatbot.llm.client: [embedding] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/text/embeddings | model=text-embeddings
2026-02-06 21:17:34,030 [INFO] chatbot.llm.client: [embedding] Response status=200 | 1447ms
2026-02-06 21:17:34,033 [INFO] chatbot.llm.client: [embedding] OK 1451ms | 1 embeddings, dims=746
2026-02-06 21:17:34,035 [INFO] chatbot.sql.pipeline_v1: [pipeline] Using 7 schemas: ['crew_roster.reservescrewmember', 'crew_roster.sequence', 'crew_roster.sequencepositiondetails', 'crew_roster.base', 'crew_roster.legalityqladetails']
2026-02-06 21:17:34,043 [INFO] chatbot.sql.pipeline_v1: [generate_sql] Sending query to LLM with 7 schemas, prompt_len=9859
2026-02-06 21:17:34,044 [INFO] chatbot.llm.client: [chat_completion] model=gpt-5-2 json_mode=False sys_prompt_chars=0 user_preview="You are a SQL expert for an American Airlines crew management database system.    
Generate a SQLite SELECT query to answer ..."
2026-02-06 21:17:34,047 [INFO] chatbot.llm.client: [chat_completion] POST https://quasarmarket.coforge.com/qag/llmrouter-api/v2/chat/completions | model=gpt-5-2
2026-02-06 21:17:52,311 [INFO] chatbot.llm.client: [chat_completion] Response status=200 | 18264ms
2026-02-06 21:17:52,313 [INFO] chatbot.llm.client: [chat_completion] OK 18266ms | response_chars=0
2026-02-06 21:17:52,314 [INFO] chatbot.sql.pipeline_v1: [generate_sql] LLM responded in 18270ms | sql=""   
2026-02-06 21:17:52,314 [WARNING] chatbot.sql.pipeline_v1: [pipeline] SQL validation failed: Only SELECT statements are allowed
2026-02-06 21:17:52,315 [WARNING] chatbot.api.chat: V1 SQL pipeline failed: Generated invalid SQL: Only SELECT statements are allowed
2026-02-06 21:17:52,316 [INFO] chatbot.api.chat: V1 response: intent=DATA has_sql=False has_results=False suggestions=0 time=23406ms
2026-02-06 21:17:52,405 [INFO] chatbot: POST /api/chat/message -> 200 (23497ms)
INFO:     127.0.0.1:54267 - "POST /api/chat/message?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
2026-02-06 21:17:53,325 [INFO] chatbot: GET /api/chat/conversations -> 200 (4ms)
INFO:     127.0.0.1:58158 - "GET /api/chat/conversations?limit=10&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInVzZXJfaWQiOjEsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc3MDM5NjM2N30.iTbHt1WzoxKohTvi4HXgvf-x_Ne6Ms3gDzFE5OhCbk0 HTTP/1.1" 200 OK
